I"‹<h1 id="objective">Objective</h1>

<p>To create a vector map of the island of Ireland (Republic of Ireland and
  Northern Ireland) with some cities.</p>

<h1 id="geographic-data">Geographic data</h1>

<p>You can get the geographic data from <a href="https://www.naturalearthdata.com">Natural Earth</a>.
You can get vector files with different themes (culture, physical), different
topics (coastline, ocean, land), and different levels of detail
(1:10m 1:50m, 1:110m).</p>

<p>Because Northern Ireland is a sovereign state, it is part of Great Britain, we need
a map that includes administrative subunits, so we can filter by the subunits later to only
include these 2 sovereign state. I will go for the maximum detail (1:10m), so I will go to 1:10m Cultural Vectors: <a href="https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_admin_0_map_subunits.zip">Admin 0 - Details: Map subunits</a>. I will also download <a href="https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_populated_places.zip">Populated Places</a> and extract some cities.</p>

<p>If you want to verify what you‚Äôve downloaded, you
can use <a href="http://mapshaper.org/">mapshaper</a> to view it in your
browser, by simply dropping the file onto the webpage and then importing the files. It is a quick way to see the differences if you are not sure about what you‚Äôre getting!</p>

<h1 id="conversion-tools">Conversion tools</h1>

<p>For Windows, you can install the geo tools from <a href="https://trac.osgeo.org/osgeo4w/">OSGeo4W</a>, which will take care of downloading
and installing everything you need to convert and manipulate the files you get from Natural Earth. You can open up <em>OSGeo4W Shell</em> to use the command-line for conversion; or you can use QGIS Desktop that has been installed, and use the GDAL Vector Processing tool inside.</p>

<p>I will do it on the command-line. I will create <em>subunits.json</em> that has the sovereign units for Ireland and Northern Ireland. We also filter the
fields to include using <em>-select</em> switch, the Natural Earth files have many fields that we are not using, so we can exclude the majority of them.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ogr2ogr -f GeoJSON -where "SU_A3 IN ('NIR', 'IRL')" -select "ADM0_A3, SU_A3, NAME_EN" subunits.json ne_10m_admin_0_map_subunits.shp
</code></pre></div></div>

<p>We create places.json for populated places in Ireland. The result is the 15 biggest cities.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ogr2ogr -f GeoJSON -where "SOV_A3 = 'IRL'" -select "ADM0_A3, SOV_A3, NAME_EN" places.json ne_10m_populated_places.shp
</code></pre></div></div>

<p>We can combine the 2 files and convert them to topojson. We get a ‚Äúcountries‚Äù layer (from subunits.json), and a ‚Äúplaces‚Äù layer (from places.json).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>geo2topo countries=subunits.json places.json &gt; ireland.json
</code></pre></div></div>

<p>You can use <a href="https://github.com/topojson/topojson-simplify/blob/master/README.md#toposimplify">toposimplify</a> to simplify the topology and reduce the file size. It did not work well for me, I tried a few different parameters, and every time it did not come out the way I wanted. I used mapshaper to do this instead and you can control how much detail you want with a slider, and see the results instantly. I reduced the filesize from 130KB to 12KB with the simplification, which is incredible!</p>

<p><img src="/assets/img/blog/2018-06-10-maps/mapshaper.png" alt="mapshaper" /></p>

<h1 id="result">Result</h1>

<p>Use D3.js to show the final result! You can read <a href="https://bost.ocks.org/mike/map/">Mike Bostock‚Äôs tutorial</a> to learn more on that.</p>

<p data-height="578" data-theme-id="light" data-slug-hash="qKReXy" data-default-tab="result" data-user="robjoeol" data-embed-version="2" data-pen-title="SVG map of Ireland with cities " class="codepen">See the Pen <a href="https://codepen.io/robjoeol/pen/qKReXy/">SVG map of Ireland with cities </a> by rob (<a href="https://codepen.io/robjoeol">@robjoeol</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<script async="" src="https://static.codepen.io/assets/embed/ei.js"></script>

<h1 id="references">References</h1>

<ul>
  <li><a href="https://bost.ocks.org/mike/map/">Let‚Äôs Make a Map by Mike Bostock</a> : - this shows how to prepare the resources well, but uses older topojson v1.</li>
  <li><a href="https://medium.com/@mbostock/command-line-cartography-part-1-897aa8f8ca2c">Command-line cartography by Mike Bostock</a> - specific to california for resources, uses topojson v2 for conversion.</li>
</ul>
:ET